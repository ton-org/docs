---
title: "Run a validator"
description: "Run a validator node with MyTonCtrl"
---

import { Aside } from '/snippets/aside.jsx';
import { Image } from '/snippets/image.jsx';

## Prerequisites

### Maintain costs and expanses

- Validator node network fee spends up to 200 TON monthly.
- Validator deposit stake 700 000 TON ~ 4 000 000 TON.
- 100 TB/month traffic at a peak load.

### Minimal hardware requirements

- 16-core CPU
- 128 GB RAM
- 1TB NVMe SSD or provisioned 64+k IOPS storage
- 1 Gbit/s network connectivity
- Public IP address (fixed IP address)

<Aside type="tip">
Typically, you'll need at least a 1 Gbit/s connection to reliably accommodate peak loads (the average load is expected to be approximately 100 Mbit/s).
We draw special attention of validators to IOPS disk requirements, it is crucially important for smooth network operation.
</Aside>

### Software requirements

- Ubuntu 22.04 LTS or 24.04 LTS
- Python 3.10
- Clang 16.0.0

![run-validator-3.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-3.png)

<Accordion title="Update Clang...">
```bash
# Please check your clang version first
clang --version
# If it is of version 16 you don't need to do the below steps.

# Required for Ubuntu 20.04 only.
sudo apt update
sudo apt install -y manpages-dev software-properties-common
sudo add-apt-repository ppa:ubuntu-toolchain-r/test
sudo apt update && sudo apt install gcc-11 g++-11

# Required for Ubuntu 20.04 and 22.04. Update current clang to clang-16
sudo apt install lsb-release wget software-properties-common gnupg
sudo wget -O - https://apt.llvm.org/llvm-snapshot.gpg.key|sudo apt-key add -
wget https://apt.llvm.org/llvm.sh
chmod +x llvm.sh
sudo ./llvm.sh 16 clang

# change default clang
sudo update-alternatives --install /usr/bin/clang clang /usr/bin/clang-16 100
sudo update-alternatives --install /usr/bin/clang++ clang++ /usr/bin/clang++-16 100
```
</Accordion>

### Port forwarding for node

<Aside type="caution">
Mandatory
</Aside>

Configure your network on server according the following:
- All outgoing connections to be open.
- A static external IP address.
- One UDP port forwarded for incoming connections
- Server must also be visible to the outside world over the NAT.

To determine which UDP ports are open, use the following command:

```bash
netstat -tulpn
```

### Validator updates announcements

Subscribe and follow instructions provided for validators with telegram channels

<Aside type="tip">
Do not ignore announcements for Testnet, validator that violate maintaining will be fined and excluded from network.
</Aside>

| Channel                                      | Network |
|----------------------------------------------|---------|
| [@tonstatus](https://t.me/tonstatus)         | Mainnet |
| [@testnetstatus](https://t.me/testnetstatus) | Testnet |

### Prepare the validator account

1. Create non-root user

```bash create validator user
sudo adduser <USERNAME>
sudo usermod -aG sudo <USERNAME>
```

2. Switch to it with reconnecting to server via ssh

```bash reconnect as the new user
exit
ssh <USERNAME>@<SERVER_IP>
```

## Validator node installation

1. Download MyTonCtrl:

```shell
wget https://raw.githubusercontent.com/ton-blockchain/mytonctrl/master/scripts/install.sh
```
![run-validator-4.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-4.png)

1. Run validator installation, installation takes approximately 20 minutes:

```shell install for Mainnet
sudo bash install.sh -m single-nominator -n mainnet
```

![run-validator-5.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-5.png)

<Accordion title="Install validator for Testnet">

```shell install for Testnet
sudo bash install.sh -m single-nominator -n testnet
```
</Accordion>

2. After installation, launch MyTonCtrl with command `mytonctrl`. Then, check synchronization status using the command:

```sh
mytonctrl
MyTonCtrl> status
```
![run-validator-2.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-2.png)

<Aside type="tip">
Initially you will see _Local validator initial sync status: downloading blockchain state xxxx_ in status, that means you node started syncronization.
</Aside>

3. Make sure your ports allowed. Print your `engine.addr` port configuration `config.json` file:
```bash
grep -A5 '"addrs"' -n /var/ton-work/db/config.json | grep '"port"' | head -1
```
![run-validator-26.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-26.png)

4. Make sure UDP `engine.addr` port allowed with following command:

```bash
sudo ufw status
```
![run-validator-26.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-26.png)

5. If you find out port filtered (absent in allowed), open this port:

```bash
sudo ufw allow <PORT_NUMBER>/udp
```

Then make sure with `sudo ufw status`.

6. Disk latency is the common bottleneck. Benchmark storage with `benchmark` command:

```sh
MyTonCtrl> benchmark
```

7. Wait until the node is fully synchronized approximately 3 hours (depends on network connection). Check the field `Local validator initial sync status: x`, the value x should become less than 20.

![run-validator-8.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-8.png)

<Aside type="tip">
Set up [alert bot](https://old-docs.ton.org/v3/guidelines/nodes/maintenance-guidelines/mytonctrl-private-alerting) to receive a notification when the node is synchronized.
</Aside>


## Configure validator

When installing, MyTonCtrl automatically creates a validator wallet for you. You need to top up and activate (deploy) this wallet so MyTonCtrl can operate Single nominator pool smart contract with it.


1. Check a list of wallets:

```sh
MyTonCtrl> wl
```
You should see a wallet named `validator_wallet_001` and its address.

![run-validator-7.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-7.png)

2. Make back-up of your validator wallet secret key:

```sh
MyTonCtrl> ew validator_wallet_001
```
![run-validator-11.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-11.png)

<Aside type="tip">
You can import this secret key with [`iw`](/ecosystem/node/mytonctrl/wallet#iw) command.
</Aside>

3. Explore your validator wallet by address with [Tonviewer](https://tonviewer.com/):

![run-validator-6.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-6.png)


3. Credit validator wallet. Ensure you have at least 200 TON/month in your validator wallet for operation fees.

![run-validator-9.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-9.png)

4. Activate the wallet:

```sh
MyTonCtrl> aw validator_wallet_001
```
![run-validator-12.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-12.png)

That also reflect in Tonviewer, status will displayed as Active
![run-validator-14.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-14.png)

5. Create a [single nominator pool](https://docs.ton.org/v3/documentation/smart-contracts/contracts-specs/single-nominator-pool) for secure stake manegment.

<Aside type="tip">
As an `owner-address`, specify the beneficiary wallet address who will stake owned funds and receive rewards. We suggest use cold wallet (Ledger) for an owner to come with securest approach.
</Aside>

```bash
MyTonCtrl> new_single_pool <pool-name> <owner-address>
```
![run-validator-15.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-15.png)



<Accordion title="If youâ€™ve already created a pool...">
If you've already created a pool, you can import it:

```bash
MyTonCtrl> import_pool <pool-name> <pool-addr>
```
</Accordion>


6. Display pool addresses using `pools_list`:

```bash
MyTonCtrl> pools_list
```

![run-validator-16.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-16.png)

At the moment your pool didn't deployed yet, and explorer will display this as `Nonexist` status:

![run-validator-17.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-17.png)

7. Activate the pool:

```bash
MyTonCtrl> activate_single_pool <pool-name>
```
![run-validator-18.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-18.png)

8. After successfully activating the pool check it again with `pools_list`:

```bash
MyTonCtrl> pools_list
```

![run-validator-19.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-19.png)

Blockchain explorer also should display now deployed contract with `Active` status

![run-validator-20.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-20.png)

9. Test deposit and withdrawal process with owner wallet. You able to make deposit from any address with direct transfer.
Credit decent sum around 10 TON:

![run-validator-21.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-21.png)

![run-validator-22.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-22.png)

10. Send withdrawal request, a message with `w` comment from `owner` wallet to single nominator pool address:

<Image
src="/resources/images/nodes/run-validator/run-validator-24.jpg"
darkSrc="/resources/images/nodes/run-validator/run-validator-24.jpg"
style={{width: "320px", height: "auto"}}
alt="Send withdrawal request"
/>

Once you restore your deposit (except 1 TON reserve on single nominator pool) to owner wallet, that means all system set securely and ready for real stake:

![run-validator-23.png](..%2F..%2Fresources%2Fimages%2Fnodes%2Frun-validator%2Frun-validator-23.png)

## Set optimal stake

Now you can top up this pool with funds enough for validation. On the next elections MyTonCtrl will automatically use this pool for staking.

<Aside type="tip">

If the pool's balance is sufficient to participate in both rounds `balance > min_stake_amount * 2`, MyTonCtrl will automatically participate in both rounds using `stake = balance / 2`, unless you manually set the stake using the `set stake` command. This behavior differs from using a nominator pool but resembles staking with a validator wallet.

</Aside>

1. Get `cycle_info.min_stake` and `cycle_info.max_stake` from API for two last cycles(WIP).
2. Chose max within two `cycle_info.min_stake` and `cycle_info.max_stake`.

```bash
cycle_info.min_stake = 450 000
cycle_info.min_stake = 500 000

min_cycle_stake = 500 000
```

```bash
cycle_info.max_stake = 2 200 000
cycle_info.max_stake = 2 150 000

max_cycle_stake = 2 200 000
```

3. Calculate expected effective stake by double `max_cycle_stake`and `min_cycle_stake`:

```bash
max_expected_effective_stake = max_cycle_stake * 2 = 2 200 000 * 2 = 2 400 000

min_expected_effective_stake = min_cycle_stake * 2 = 500 000 * 2 = 1 000 000
```

Effective stake defined with: `min_expected_effective_stake <= effective stake <= max_expected_effective_stake`

4. Deposit directly to single nominator pool address effective stake.
5. Next election cycle (odd), mytonctrl will send half of stake from single nominator pool. Track this with browser.
6. Next paired election cycle (even), mytonctrl will send second half of stake from single nominator pool. Track this with browser.
7. Reward for odd validation cycle will return to single nominator pool united with stake. Track this with browser.
8. Once you make sure you pair stakes circulated properly, you may focus on monitor validator health and updates.



## Maintain (WIP)

1. Follow [@tonstatus](https://t.me/tonstatus), turn on notifications, and be prepared for urgent updates if needed.

2. Create validator backup. Learn about [backups](/v3/guidelines/nodes/maintenance-guidelines/mytonctrl-backup-restore#automated-backup-location-and-lifecycle).

3. Set up alerting in MyTonCtrl to notify you of critical issues with your validator. For more information, see [MyTonCtrl private alerting bot](/v3/guidelines/nodes/maintenance-guidelines/mytonctrl-private-alerting) or (and) check [MyTonCtrl public alerting bot](https://t.me/validators).

4. Set up monitoring dashboards for RAM, disk, network, CPU usage and other metrics. See also [MyTonCtrl prometheus export](/v3/guidelines/nodes/maintenance-guidelines/mytonctrl-prometheus). For technical assistance, please contact [@mytonctrl_help_bot](https://t.me/mytonctrl_help_bot).

5. Monitor the efficiency of your validator with dashboards.

  - Please verify with `MyTonCtrl` using the `check_ef` command.

  - Check [Build dashboard with APIs](/v3/guidelines/nodes/running-nodes/validator-node#validation-effectiveness-apis).

<Info>`MyTonCtrl` enables you to evaluate the performance of validators using the command `check_ef`. This command provides efficiency data for both the last round and the current round. The data is retrieved by calling the `checkloadall` utility. Make sure that your efficiency is above 90% for the entire round period.</Info>

<Info>If you encounter low efficiency, take action to resolve the issue. If necessary, contact technical support at [@mytonctrl_help_bot](https://t.me/mytonctrl_help_bot).</Info>

### Learn slashing policy

If a validator processes less than 90% of the expected blocks during a validation round, they will be fined by 101 TON.

Learn more about the [slashing policy](/v3/documentation/nodes/validation/staking-incentives#decentralized-system-of-penalties).


## Validation effectiveness APIs

<Info>Please set up dashboards to monitor your validators using the APIs provided below.</Info>

### Penalized validators tracker

You can track penalized validators on each round with [@tonstatus_notifications](https://t.me/tonstatus_notifications).

#### Validation API

You can use this [API](https://elections.toncenter.com/docs) to obtain information about current and past validation rounds (cycles) - including the timing of rounds, which validators participated, their stakes, and more. Information regarding current and past elections for each validation round is also available.

#### Efficiency API

You can use this [API](https://toncenter.com/api/qos/index.html#/) to obtain information about the efficiency of validators over time.

This API analyzes data from the catchain to provide an estimate of a validator's efficiency. It serves as an alternative to the `checkloadall` utility.

Unlike `checkloadall`, which only works on validation rounds, this API allows you to set any time interval to analyze a validator's efficiency.

##### Workflow:

1. To the API, provide the ADNL address of your validator along with a time interval (`from_ts`, `to_ts`). For accurate results, choose a sufficient interval, such as 18 hours ago to the present moment.

2. Retrieve the result. If your efficiency percentage is below 80%, your validator is malfunctioning.

3. Your validator must actively participate in validation and use the same ADNL address throughout the specified time period. For example, if a validator contributes to validation every second round, you should only indicate the intervals during which they participated. Failing to do so may result in an inaccurate underestimate. This requirement applies not only to MasterChain validators (with an index \< 100) but also to other validators (with an index > 100).

## Support

Contact technical support [@mytonctrl_help_bot](https://t.me/mytonctrl_help_bot). This bot is for validators only and will not assist with questions for regular nodes.
