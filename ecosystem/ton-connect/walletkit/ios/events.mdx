---
title: "How connect to dApp and handle wallet events on the iOS platform"
sidebarTitle: "Handle events"
---

<Aside type="tip">
  Initialize the WalletKit before adding events handler. See the [initialization guide](./init) for details.
</Aside>

## Connection

Before you will be able to receive and handle wallet events you need to setup events handler and establish a connection with dApp

### Setting up events handler

You need to create your own implementation of events handler and add to Wallet Kit instance

```swift
import TONWalletKit

class YourCustomWalletEventsHandler: TONBridgeEventsHandler {

    func handle(event: TONWalletKitEvent) throws {
        // You are able to handle event or throw an error
    }
}

let eventsHandler = YourCustomWalletEventsHandler()
try await walletKit.add(eventsHandler: eventsHandler)

// Additionally you can explicitly remove event handler
try await walletKit.remove(eventsHandler: eventsHandler)

// Once TONWalletKit instance is deinited handlers will not receive events anymore
```

### Establishing connection with dApp

To establish a connection with dApp you need to get a URL for connection request from any source (copy/paste, QRCode, deep link and etc.).

Once you have a connection URL you need to send it to Wallet Kit to perform connection request.

```swift
try await walletKit.connect(url: /* connection url */)
```

Once connecting request is performed, a connection event will be send to your events handler.

Connection event containing an object that you can use to display request information to user of your app and to approve (or reject) request to finish connection establishment.

```swift
class YourCustomWalletEventsHandler: TONBridgeEventsHandler {

    func handle(event: TONWalletKitEvent) throws {
        switch event {
        case .connectRequest(let request):
            // Send request object to appropriate screen to display request information to app user
        default: ()
        }
    }
}

// Call appropriate method for corresponding app user action performed on some screen

// To approve
try await request.approve(walletAddress: /* TON wallet address */)

// To reject
try await request.reject(reason: /* rejection reason */)
```

After approval, connection will be established and you will be able to receive and handle other events associated with corresponding wallet.

## Handling events

All events handling is made through custom events handler.

Received events have corresponding object you can use to show information to user and to approve or reject request depending on user action.

The only exclusion is a disconnection request. Even though it contains information you can use to should to a user, no need to approve or reject it.

### Transaction event handling

```swift
class YourCustomWalletEventsHandler: TONBridgeEventsHandler {

    func handle(event: TONWalletKitEvent) throws {
        switch event {
        case .transactionRequest(let request):
            // Send request object to appropriate screen to display request information to app user
        default: ()
        }
    }
}

// Call appropriate method for corresponding app user action performed on some screen

// To approve
try await request.approve()

// To reject
try await request.reject(reason: /* rejection reason */)
```

### Sign data event handling

```swift
class YourCustomWalletEventsHandler: TONBridgeEventsHandler {

    func handle(event: TONWalletKitEvent) throws {
        switch event {
        case .signDataRequest(let request):
            // Send request object to appropriate screen to display request information to app user
        default: ()
        }
    }
}

// Call appropriate method for corresponding app user action performed on some screen

// To approve
try await request.approve()

// To reject
try await request.reject(reason: /* rejection reason>* /)
```

### Disconnection event handling

```swift
class YourCustomWalletEventsHandler: TONBridgeEventsHandler {

    func handle(event: TONWalletKitEvent) throws {
        switch event {
        case .disconnect(let info):
            // Send info object to appropriate screen to display request information to app user
        default: ()
        }
    }
}
```

Alternatively, explore the complete demo wallet with WalletKit integration:

<Card title="Demo wallet, GitHub" icon="github" horizontal href="https://github.com/ton-connect/kit-ios/tree/main/Demo">
  
</Card>