---
title: "How connect to dApp and handle wallet events on the Android platform"
sidebarTitle: "Handle events"
---
import { Aside } from '/snippets/aside.jsx';

<Aside type="tip">
  Initialize the WalletKit before adding events handler. See the [initialization guide](./init) for details.
</Aside>

## Connection

Before you will be able to receive and handle wallet events you need to setup events handler and establish a connection with dApp

### Setting up events handler

You need to create your own implementation of events handler and add to Wallet Kit instance

```kotlin
import io.ton.walletkit.ITONWalletKit
import io.ton.walletkit.listener.TONBridgeEventsHandler
import io.ton.walletkit.event.TONWalletKitEvent

class YourCustomWalletEventsHandler : TONBridgeEventsHandler {

    override fun handle(event: TONWalletKitEvent) {
        // You are able to handle event or throw an error
    }
}

val eventsHandler = YourCustomWalletEventsHandler()
walletKit.addEventsHandler(eventsHandler)

// Additionally you can explicitly remove event handler
walletKit.removeEventsHandler(eventsHandler)
```

### Establishing connection with dApp

To establish a connection with dApp you need to get a URL for connection request from any source (copy/paste, QRCode, deep link and etc.).

Once you have a connection URL you need to send it to wallet to perform connection request.

```kotlin
wallet.connect(/* connection url */)
```

Once connecting request is performed, a connection event will be send to your events handler.

Connection event containing an object that you can use to display request information to user of your app and to approve (or reject) request to finish connection establishment.

```kotlin
class YourCustomWalletEventsHandler : TONBridgeEventsHandler {

    override fun handle(event: TONWalletKitEvent) {
        when (event) {
            is TONWalletKitEvent.ConnectRequest -> {
                // Send request object to appropriate screen to display request information to app user
            }
            else -> {}
        }
    }
}

// Call appropriate method for corresponding app user action performed on some screen

// To approve
request.approve(walletAddress = /* TON wallet address */)

// To reject
request.reject(reason = /* rejection reason */)
```

After approval, connection will be established and you will be able to receive and handle other events associated with corresponding wallet.

## Handling events

All events handling is made through custom events handler.

Received events have corresponding object you can use to show information to user and to approve or reject request depending on user action.

The only exclusion is a disconnection request. Even though it contains information you can use to should to a user, no need to approve or reject it.

### Transaction event handling

```kotlin
class YourCustomWalletEventsHandler : TONBridgeEventsHandler {

    override fun handle(event: TONWalletKitEvent) {
        when (event) {
            is TONWalletKitEvent.TransactionRequest -> {
                // Send request object to appropriate screen to display request information to app user
            }
            else -> {}
        }
    }
}

// Call appropriate method for corresponding app user action performed on some screen

// To approve
request.approve()

// To reject
request.reject(reason = /* rejection reason */)
```

### Sign data event handling

```kotlin
class YourCustomWalletEventsHandler : TONBridgeEventsHandler {

    override fun handle(event: TONWalletKitEvent) {
        when (event) {
            is TONWalletKitEvent.SignDataRequest -> {
                // Send request object to appropriate screen to display request information to app user
            }
            else -> {}
        }
    }
}

// Call appropriate method for corresponding app user action performed on some screen

// To approve
request.approve()

// To reject
request.reject(reason = /* rejection reason */)
```

### Disconnection event handling

```kotlin
class YourCustomWalletEventsHandler : TONBridgeEventsHandler {

    override fun handle(event: TONWalletKitEvent) {
        when (event) {
            is TONWalletKitEvent.Disconnect -> {
                // Send info object to appropriate screen to display request information to app user
            }
            else -> {}
        }
    }
}
```

Alternatively, explore the complete demo wallet with WalletKit integration:

<Card
  title="Demo wallet, GitHub"
  icon="github"
  horizontal
  href="https://github.com/ton-connect/kit-android/tree/main/AndroidDemo"
/>
