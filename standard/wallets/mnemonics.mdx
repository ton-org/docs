---
title: "Mnemonic phrases"
sidebarTitle: "Mnemonics"
---

import { Aside } from '/snippets/aside.jsx';


## Key pair 

The Open Network (TON) blockchain uses asymmetric cryptography, such as the [Ed25519](https://en.wikipedia.org/wiki/EdDSA#Ed25519) signature scheme.

There are multiple ways to derive a key pair from a mnemonic. This page describes the most common approach in TON.

<Aside type="note">
  Some apps in the TON ecosystem may use a different derivation method, eventually producing an Ed25519-conformant key pair.
</Aside>

## Key pair from a mnemonic

To transform a mnemonic phrase into a key pair, a `seed` is first derived using [Password-Based Key Derivation Function 2 (PBKDF2)](https://en.wikipedia.org/wiki/PBKDF2), and the key pair is then derived from that `seed`.

PBKDF2 has [five input parameters](https://en.wikipedia.org/wiki/PBKDF2#Key_derivation_process): `PRF`, `Password`, `Salt`, `c`, and `dkLen`. Each of those parameters is assigned a concrete value.

The most commonly used values are:

| Parameter  | Description | Value
| :--------- | :---------- | :----
| `PRF`      | Pseudo-random function (PRF) of two parameters | [HMAC‑SHA512](https://en.wikipedia.org/wiki/HMAC) (hash‑based message authentication code with SHA‑512)
| `Password` | Master password from which a derived key is generated | `""`
| `Salt`     | Sequence of bits, known as a [cryptographic salt](https://en.wikipedia.org/wiki/Salt_(cryptography)) | `"TON default seed"`
| `c`        | Number of iterations desired | `100000`
| `dkLen`    | Desired bit-length of the derived key | `64`

### Generate a key pair 

```typescript title="TypeScript"
import { mnemonicToPrivateKey, mnemonicNew } from "@ton/crypto";

// Replace with your own persisted mnemonic phrase.
const mnemonicArray = await mnemonicNew();

// derive private and public keys from the mnemonic
const keyPair = await mnemonicToPrivateKey(mnemonicArray); 

console.log("Public Key: " + keyPair.publicKey.toString('hex'));
// Do not print or log private keys.
```

The private key is needed to sign messages, and the public key is stored in the wallet's [smart contract](/ton/glossary#smart-contract). When new external messages arrive on that smart contract, the public key is used to check the authenticity of the messages signed using the corresponding private key.

<Aside type="note" title="Important">
  Save the generated mnemonic phrase. If you need deterministic behavior during development, print and reuse the exact phrase so the wallet derives the same key pair on every run.
</Aside>

## Validate a mnemonic 

1. Check that all the words are from the list of [Bitcoin Improvement Proposal 39 (BIP‑39)](https://github.com/ton-org/ton-crypto/blob/c3435833a0da52a96f674c352c4c6f91fcc07f6d/src/mnemonic/wordlist.ts#L9).
1. If a password is used, the first byte of the derived `seed` computed with `c = 1` and `salt = `"TON fast seed version"` must equal `0`.
1. If no password is used, the first byte of the derived `seed` computed with `c = floor(100000/256) = 390` and `salt = `"TON seed version"` must equal `1`.

Generate random mnemonic phrases until PBKDF2 yields a seed whose first byte matches the expected version (0 for the `"fast seed"` parameters, 1 for the `"seed version"` parameters). Then return a valid mnemonic.

### Generate a mnemonic

```typescript title="TypeScript"
import { mnemonicNew } from "@ton/crypto";

const mnemonicArray = await mnemonicNew(); 
// Do not print mnemonic phrases. Store them securely instead.
```
