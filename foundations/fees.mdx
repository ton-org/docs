---
title: "Transaction fees"
---

import { Aside } from '/snippets/aside.jsx';


Fees in the TON blockchain are strongly connected with the [execution phases](/foundations/phases) of a transaction. More specifically,
- Storage fees are charged in the [storage phase](/foundations/phases#storage-phase)
- Compute fees are charged in the [compute phase](/foundations/phases#compute-phase)
- Forward and action fees are charged in the [action](/foundations/phases#action-phase) and [bounce phase](/foundations/phases#bounce-phase)
- Import fees are not connected to a particular phase, they are charged in the beginning of smart contract execution.

The sum of all fees is the total transaction fee.

The fee level can be changed through a vote by validators. More specifically,
- The level of storage fees is determined in [the 18th config parameter](/foundations/config#param-18:-storage-prices)
- The level of compute fees is determined in [the 20th and 21st config parameters](/foundations/config#param-20-and-21:-gas-prices)
- The level of forward, import and action fees is determined in [the 24th and 25th config parameters](/foundations/config#param-24-and-25:-message-price)

## Storage fees

```cpp title="FORMULAS"
basic_price = (account.bits * bit_price +
              account.cells * cell_price)
storage_fee = ceil(basic_price * time_delta / 2^16)
```

When calculating storage fees, the `account.bits` and `account.cells` are calculated from the `AccountStorage` structure, excluding `ExtraCurrencyCollection`, stored in the `other` field. The content of `other` field is replaced with one bit equal to `0`, which means empty `HashmapE`.

```tl-b
extra_currencies$_ dict:(HashmapE 32 (VarUInteger 32))
                 = ExtraCurrencyCollection;
currencies$_ grams:Grams other:ExtraCurrencyCollection
           = CurrencyCollection;

account_storage$_ last_trans_lt:uint64
    balance:CurrencyCollection state:AccountState
  = AccountStorage;
```

<Aside
  type="note"
  title="Deduplication"
>
  The system counts only unique hash cells for storage and forward fees. For example, it counts three identical hash cells as one. This mechanism deduplicates data by storing the content of multiple equivalent sub-cells only once, even if they are referenced across different branches.
</Aside>

